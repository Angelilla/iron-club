{{!-- user/instructor list of activities where he/she can edit, delete and coment --}}
{{!-- NEEDS PARTIAL activity-lististructor.hbs and activity-listuser.hbs  --}}




authRouter.post('/signup', parser.single('profilepic'), async (req, res, next) => {
  console.log('req.body', req.body);
  const { name, email, password } = req.body;
  const image_url = req.file.secure_url;

  if(email === "" || password === "") {
    res.render('auth/signup', { errorMessage: "Enter both email and password "});
    return;
  }
  try {
      
    const foundUser = await User.findOne({ email })
    if(foundUser) {
      res.render('auth/signup', { errorMessage: `There's already an account with the email ${email}`});
      return;
    }
    
    const salt = bcrypt.genSaltSync(saltRounds);
    const hashedPassword = bcrypt.hashSync(password, salt);
    
    // esto "profilepic: image_url " es para pasar el profilepic
    await User.create({ name, email, password: hashedPassword, profilepic: image_url  })
    
    res.redirect('/login'); //levantar sesion al hacer signup
  } 
  catch (error) {
    res.render('auth/signup', { errorMessage: "Error while creating account. Please try again."})
  }
})